knitr::opts_chunk$set(echo = TRUE)
load("data/nba2017-salary-points.RData")
ls()
replace = replace(experience,experience=="R","0")
experience_new <- as.integer(replace)
experience_new
class(experience_new)
library(plyr)
download.packages("plyr")
download.packages(plyr)
install.packages("plyr")
library(plyr)
mapvalues(position_new,from=c("C","SF","PF","SG","PG"),to=c("center","small_fwd","power_fwd","shoot_guard","point_guard"))
position_new <- as.factor(position)
install.packages("plyr")
install.packages("plyr")
library(plyr)
mapvalues(position_new,from=c("C","SF","PF","SG","PG"),to=c("center","small_fwd","power_fwd","shoot_guard","point_guard"))
table(position_new)
position_updated <- mapvalues(position_new,from=c("C","SF","PF","SG","PG"),to=c("center","small_fwd","power_fwd","shoot_guard","point_guard"))
table(position_updated)
?par
plot(points,million_salary)
million_salary <- round(million/1000000,2)
replace = replace(experience,experience=="R","0")
million_salary <- round(million/1000000,2)
million_salary <- round(salary/1000000,2)
replace = replace(experience,experience=="R","0")
plot(points,million_salary)
plot(points,million_salary,col=red)
plot(points,million_salary,col="red")
plot(points,million_salary,col="pink")
plot(points,million_salary,col="pink",cex=2)
plot(points,million_salary,col="pink",cex=0.5)
plot(points,million_salary,col="pink",cex=0.5,lab(10,10))
plot(points,million_salary,col="pink",cex=0.5,xlab=10)
plot(points,million_salary,col="pink",cex=0.5,xlab=1)
plot(points,million_salary,col="pink",cex=0.5,xlab=1)
plot(points,million_salary,col="pink",cex=0.5,xlab=10)
plot(points,million_salary,col="pink",cex=0.5,xlab=50)
plot(points,million_salary,col="pink",cex=0.5)
plot(points,million_salary,col="pink",cex=0.5,xlab="NBA POINTS",ylab="NBA Salary(millions)",main="POINTS-SALARY PLOT")
plot(points,million_salary,pch=19, col="orange",cex=0.5,xlab="NBA Points",ylab="Salary(in millions)",main="Scatter plot of points and salary")
n=length(NBA Points)
n=length(points)
bar(x)=sum(points)/length(points)
sd_x = sd(points)
sd_y = sd(million_salary)
var_x = (points-x_average)/(length(points)-1)
x_average=sum(points)/length(points)
y_average=sum(million_salary)/length(million_salary)
var_x = (points-x_average)/(length(points)-1)
cov_x_y = (points-x_average)*(million_salary-y_average)/(length(x)-1)
cov_x_y = (points-x_average)*(million_salary-y_average)/(length(points)-1)
cor_x_y = cov_x_y/(sd_x*sd_y)
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
"y-hat"=b0+b1*(points)
```{r}
million_salary <- round(salary/1000000,2)
replace = replace(experience,experience=="R","0")
experience_new <- as.integer(replace)
position_new <- as.factor(position)
install.packages("plyr")
library(plyr)
install.packages("plyr")
load("data/nba2017-salary-points.RData")
million_salary <- round(salary/1000000,2)
replace = replace(experience,experience=="R","0")
library(plyr)
```{r}
```{r}
load("data/nba2017-salary-points.RData")
ls()
million_salary <- round(salary/1000000,2)
replace = replace(experience,experience=="R","0")
qexperience_new <- as.integer(replace)
position_new <- as.factor(position)
summary("y_hat")
summary(y)
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
y=b0+b1*(points)
summary(y)
"y-hat"=b0+b1*(points)
summary("y-hat")
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
"y-hat"=b0+b1*(points)
summary("y-hat")
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
y=b0+b1*(points)
summary(y)
summary(hat(y))
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
hat(y)=b0+b1*(points)
summary(hat(y))
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
hat(y)=b0+b1*(points)
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
hat(y) <- b0+b1*(points)
summary(y)
b1=cor_x_y*sd_y/sd_x
b0=y_average-b1*x_average
y = b0+b1*(points)
summary(y)
million_salary <- as.numeric(round(salary/1000000,2),nsmall <-2)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
load("data/nba2017-salary-points.RData")
ls()
#Create a new salary variable
million_salary <- as.numeric(round(salary/1000000,2),nsmall <-2)
#Create a new experience variable
replace = replace(experience,experience=="R","0")
experience_new <- as.integer(replace)
#Create a new position variable
position_new <- as.factor(position)
#Create more descriptive labels
install.packages("plyr")
library(plyr)
position_updated <- mapvalues(position_new,from=c("C","SF","PF","SG","PG"),to=c("center","small_fwd","power_fwd","shoot_guard","point_guard"))
table(position_updated)
plot(points,million_salary,pch=19, col="orange",cex=0.5,xlab="NBA Points",ylab="Salary(in millions)",main="Scatter plot of points and salary")
install.packages("plyr")
b1=cor_x_y*sd_y/sd_x
b1
cov_x_y = sum((points-x_average)*(million_salary-y_average))/(n-1)
cor_x_y = cov_x_y/(sd_x*sd_y)
cor_x_y = cov_x_y/(sd_x*sd_y)
b1=cor_x_y*sd_y/sd_x
b1
b0=y_average-b1*x_average
y_hat <- b0+b1*(points)
summary(y_hat)
y(0)
y_hat(0)
y_hat <- b0+b1*(points)
summary(y_hat)
y_hat(0)
b1
bo
b0
b1
b0 +b1*0
b0 + b1*100
b0 + b1*500
b0 + b1*1000
b0 + b1*2000
?abline
?lowess
plot(points,million_salary,abline(a=1.509077,b=0.008557567,lowess(points,million_salary)))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19)
?lines
abline(lowess(experience_new, salary_new), lwd = 4, col = 'red')
abline(a=1.509077,b=0.008557567,lwd=1,col="purple")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19)
abline(a=1.509077,b=0.008557567,lwd=1,col="purple")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19)
abline(a=1.509077,b=0.008557567,lwd=1,col="purple")
line(a=1.509077,b=0.008557567,lwd=1,col="purple")
line(a=1.509077, b=0.008557567, lwd=1, col="purple")
abline(a=1.509077, b=0.008557567, lwd=1, col="purple")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary,col="orange"))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"),lines(lowess(points,million_salary,col="orange"))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"),lines(lowess(points,million_salary),col="orange"))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"),lowess(points,million_salary,col="orange")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"),lowess(points,million_salary,col="orange")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
?lowess
lines(lowess(points,million_salary),col="red")
lines(lowess(experience_new, salary_new), lwd = 4, col = 'red')
plot(
experience_new,
salary_new,
main = 'Scatterplot with lowess smooth',
xlab = 'Years of Experience',
ylab = 'Salary (in millions)',
col = 'grey'
)
lines(lowess(points,million_salary),col="red")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"),lines(lowess(points,million_salary),col="red"))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"),lines(lowess(points,million_salary),col="red"))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
e = millions_salary - y_hat
e = million_salary - y_hat
e
summary(e)
RSS=sum(e^2)
RSS
TSS=sum((millions_salary-mean(million_salary)^2)
TSS=sum((millions_salary-mean(million_salary)^2)
TSS=sum((millions_salary-mean(million_salary))^2)
TSS=sum((million_salary-mean(million_salary))^2)
TSS
R_2= 1-RSS/TSS
R_2
abline(a = 1.509077, b = 0.008557567, lwd = 4, col = 'blue',)
plot(
points,
salary_new,
main = 'Regression and Lowess Lines',
xlab = 'Points',
ylab = 'Salary (in millions)',
col = 'grey'
)
salary_new <-
as.numeric(format(round(salary / 1000000, 2), nsmall <-  2))
experience_new <- as.integer(replace(experience,experience == 'R',0))
position_new <- factor(position)
levels(position_new) <-
c('center',
'small_fwd',
'power_fwd',
'shoot_guard',
'point_guard')
plot(
points,
salary_new,
main = 'Scatterplot of Points and Salary',
xlab = 'Points',
ylab = 'Salary (in millions)',
col = 'red'
)
n <- length(player)
mean_x <- sum(points)/n
mean_x
mean_y <- sum(salary_new)/n
mean_y
var_x <- sum((points - mean_x)**2)/(n-1)
var_x
var_y <- sum((salary_new - mean_y)**2)/(n-1)
var_y
sd_x <- sqrt(var_x)
sd_x
sd_y <- sqrt(var_y)
sd_y
covariance <- sum((points-mean_x)*(salary_new-mean_y))/(n-1)
covariance
correlation <- covariance/((sd_x)*(sd_y))
correlation
b1 <- (correlation)*(sd_y/sd_x)
b1
b0 <- mean_y-(b1*mean_x)
b0
y_hat <- b0 + b1*points
y_hat
summary(y_hat)
plot(
points,
salary_new,
main = 'Regression and Lowess Lines',
xlab = 'Points',
ylab = 'Salary (in millions)',
col = 'grey'
)
abline(a = 1.509077, b = 0.008557567, lwd = 4, col = 'blue',)
lines(lowess(points, salary_new), lwd = 4, col = 'red')
plot(experience_new,million_salary,main="Scatterplot with lowess smooth",xlab="Years of Experience",ylab="Salary(in million)",col="black")
plot(experience_new,million_salary,main="Scatterplot with lowess smooth",xlab="Years of Experience",ylab="Salary(in million)",col="black",pch=19)
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red")
install.packages("scatterplot3d")
library(scatterplot3d)
?scatterplot 3d
?scatterplot3d
lines(lowess(points,million_salary),col="red",lwd=3)
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
scatterplot3d(points,experience_new,million_salary,col="orange",pch=19,main="3D Scatterplot",xlab="points",ylan="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,col="red",pch=19,main="3D Scatterplot",xlab="points",ylan="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,col="red", pch=19,main="3D Scatterplot",xlab="points",ylan="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,pch=19,main="3D Scatterplot",xlab="points",ylan="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,col="orange", pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,col="red", pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,color="red", pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,color="orange", pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,color="orange", pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience")
scatterplot3d(points,experience_new,million_salary,color="orange", pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience",scale.y=1.5)
scatterplot3d::scatterplot3d (points, experience_new, salary_new, xlab = 'points', ylab = 'experience', zlab = 'salary', main = '3D Scatterplot', color = 'red', scale.y = 1.3, angle = 55)
?boxplot
boxplot(data=scatterplot3d)
boxplot(x,data=scatterplot3d)
boxplot(salary_new ~ position_new, xlab = 'Position', ylab = 'Salary (in millions)')
boxplot(million_salary ~ position_new, )
boxplot(million_salary ~ position_new, xlab="Position",ylab="Salary(in millions)")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
load("data/nba2017-salary-points.RData")
ls()
million_salary <- as.numeric(round(salary/1000000,2),nsmall <-2)
replace = replace(experience,experience=="R","0")
experience_new <- as.integer(replace)
position_new <- as.factor(position)
install.packages("plyr")
install.packages("plyr")
library(plyr)
position_updated <- mapvalues(position_new,from=c("C","SF","PF","SG","PG"),to=c("center","small_fwd","power_fwd","shoot_guard","point_guard"))
table(position_updated)
plot(points,million_salary,pch=19, col="orange",cex=0.5,xlab="NBA Points",ylab="Salary(in millions)",main="Scatter plot of points and salary")
n <- length(points)
x_average <- sum(points)/n
var_x <- (points-x_average)^2/(n-1)
var_y <-  (points-y_average)^2/(n-1)
sd_x <-  sqrt(var_x)
sd_y <-  sqrt(var_y)
cov_x_y <-  sum((points-x_average)*(million_salary-y_average))/(n-1)
cor_x_y <-  cov_x_y/(sd_x*sd_y)
b1 <- cor_x_y*sd_y/sd_x
b1
b0 <- y_average-b1*x_average
b0
y_hat <- b0+b1*(points)
summary(y_hat)
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
abline(a=1.509077, b=0.008557567, lwd=1, col="purple"
lines(lowess(points,million_salary),col="red",lwd=3)
abline(a=1.509077, b=0.008557567, lwd=1, col="purple")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"),lines(lowess(points,million_salary),col="red",lwd=3))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
lines(lowess(experience_new, salary_new), lwd = 4, col = 'red')
plot(
experience_new,
salary_new,
main = 'Scatterplot with lowess smooth',
xlab = 'Years of Experience',
ylab = 'Salary (in millions)',
col = 'grey'
)
lines(lowess(experience_new, salary_new), lwd = 4, col = 'red')
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
text(x = c(2400,2500), y = c(20,30) , labels = c('regression','lowess'), col = c('blue','red'))
getwd()
setwd("~/Desktop/stat133/stat133-hws-fall17/hw01")
load("data/nba2017-salary-points.RData")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
lines(lowess(points,million_salary),col="red",lwd=3)
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
?text
text(x=c(2400,2500),y=c(20,25),labels=c(regression,lowess),col=("purple","red"))
text(x=c(2400,2500),y=c(20,25),labels=c(regression,lowess),col=c("purple","red")
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
text(x=c(2400,2500),y=c(20,25),labels=c(regression,lowess),col=c("purple","red"))
text(x=c(2400,2500),y=c(20,25),labels=c(regression,lowess),col=c("purple","red"))
plot(points,million_salary,main="Regression and Lowess line",xlab="Points",ylab="Salary(in millions)",col="gray",pch=19,abline(a=1.509077, b=0.008557567, lwd=1, col="purple"))
lines(lowess(points,million_salary),col="red",lwd=3)
text(x=c(2400,2500),y=c(20,25),labels=c("regression","lowess"),col=c("purple","red"))
lines(lowess(experience_new,million_salary),col="orange",lwd=3)
#A scatterplot of Years_of_Experience and Salary
plot(experience_new,million_salary,main="Scatterplot with lowess smooth",xlab="Years of Experience",ylab="Salary(in million)",col="black",pch=19)
lines(lowess(experience_new,million_salary),col="orange",lwd=3)
????#3D scatterplot of Points,Experience, and Salary
install.packages("scatterplot3d")
library(scatterplot3d)
scatterplot3d<-scatterplot3d(points,experience_new,million_salary,color="orange", pch=19,main="3D Scatterplot",xlab="points",ylab="salary",zlab="experience")
#A conditional boxplot of salary in terms of position
boxplot(million_salary ~ position_new, xlab="Position",ylab="Salary(in millions)")
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
load("data/nba2017-salary-points.RData")
ls()
#Create a new salary variable
million_salary <- as.numeric(round(salary/1000000,2),nsmall <-2)
million_salary
#Create a new experience variable
replace = replace(experience,experience=="R","0")
experience_new <- as.integer(replace)
experience_new
#Create a new position variable
position_new <- as.factor(position)
position_new
#Create more descriptive labels
library(plyr)
position_updated <- mapvalues(position_new,from=c("C","SF","PF","SG","PG"),to=c("center","small_fwd","power_fwd","shoot_guard","point_guard"))
position_updated
#The frequency of each position
table(position_updated)
